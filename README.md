## LM Syntactic Generalization

### Getting colorlessgreenRNNs

Download [colorlessgreenRNNs](https://github.com/facebookresearch/colorlessgreenRNNs/) from [Gulordava et al](https://aclanthology.org/N18-1108/). Then download the [full English vocab](https://dl.fbaipublicfiles.com/colorless-green-rnns/training-data/English/vocab.txt) and [English langyage model model](https://dl.fbaipublicfiles.com/colorless-green-rnns/best-models/English/hidden650_batch128_dropout0.2_lr20.0.pt).

The vocab should be saved at `colorlessgreenRNNs/src/data/lm` (you may have to make a new folder), and the model should be saved to `colorlessgreenRNNs/src/models`.

### CFGs and Sentence Generation

The file `grammars.py` contains text-based specifications for the different CFGs based on appendices from [Lan et al](https://lingbuzz.net/lingbuzz/006829).

### Data

Example sentences generated by each of the CFGs formatted as JSON is located in `grammar_outputs/sentence_lists`. 2x2 tuples containing each sentence type for each CFG are located in `grammar_outputs/tuples`, also in JSON format.

### Retraining Models

To augment the training data, run `python augment_with_dependency.py --data_dir $DATA --dependency_name $DEPENDENCY --augmenting_data $CFG_DIR`, where `$DATA`corresponds to the LM's training data that's already split into training and validation sets (should have `train.txt` and `valid.txt`). If you downloaded data from the Gulordava et al repo this should be done for you. This will create a folder named `$DEPENDENCY` with augmented training data. `$CFG_DIR` should be set to a CSV in `grammar_outputs/revised_training`. Before running the line above, set the environment variable appropriately.

There are scripts to retrain the model on the CLIP cluster, I modified `retrain_grnn.sh` to train RNNs on clefting and topicalization at the same time. To run inference with a retrained model, change the path in `surprisal.py` from the pretrained RNN model, make a directory in `grammar_outputs`, modify `cfg_sentence_generation.py`, and then run it.

##### Notes:

`colorlessgreenRNNs` is from [Gulordava et al](https://aclanthology.org/N18-1108/), available via Facebook Research at [colorlessgreenRNNs](https://github.com/facebookresearch/colorlessgreenRNNs/).
